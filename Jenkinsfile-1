// library identifier: 'jenkins-share-library@master', retriever: modernSCM(
//   [$class: 'GitSCMSource',
//    remote: 'git@github.com:return200-ok/jenkins-share-library.git',
//    credentialsId: 'github-caolv'])

library identifier: 'jenkins-share-library@master', retriever: modernSCM(
  github(traits: [gitHubBranchDiscovery(1), 
  gitHubPullRequestDiscovery(1), 
  gitHubForkDiscovery(strategyId: 1, trust: gitHubTrustPermissions())], 
  credentialsId: 'github-caolv', 
  repository: 'jenkins-share-library', 
  repoOwner: 'return200-ok'))

pipeline {
  agent any
  options {
    buildDiscarder(logRotator(numToKeepStr: '5'))
  }
  stages {
    stage('Scan') {
      steps {
        // withSonarQubeEnv(installationName: 'sq1') { 
        //   sh './mvnw clean sonar:sonar'
        // }
        script{
          echo 'foo bar'
          checkOutFrom(branches:"develop", repo_url:"https://bitbucket_biplus@bitbucket.org/bipluscode/mygo-agent.git", CREDENTIAL_ID: "d281bfc1-1637-4c18-a8a2-cf3567ce567f")
        }
      }
    }
  }
}